#!/usr/bin/env ruby
$: << File.expand_path('../../lib', __FILE__)
require 'dat'
require 'tach'
include Dat

$clogic = Logic.new
$rblogic = Pure::Logic.new

d = Dict.new

def rand_word
  (0...8).map{65.+(rand(25)).chr}.join
end

Tach.meter(10000) do

  # perturb

  tach('c-logic random perturb') do
    $clogic.perturb(rand_word, d)
  end

  tach('rb-logic random perturb') do
    $rblogic.perturb(rand_word, d)
  end

  tach('c-logic perturb') do
    $clogic.perturb('DAT', d)
  end

  tach('rb-logic perturb') do
    $rblogic.perturb('DAT', d)
  end

  # leven

  tach('c-logic random leven') do
    $clogic.leven(rand_word, rand_word)
  end
  tach('rb-logic random leven') do
    $rblogic.leven(rand_word, rand_word)
  end

  tach('c-logic leven') do
    [['CA', 'ABC'], ['TEUSDAY', 'TUESDAY'], ['TEUSDAY', 'THURSDAY'], ['TUESDAY', 'SOMETHING']].each do |a|
      @clogic.leven *a
    end
  end

  tach('rb-logic leven') do
    [['CA', 'ABC'], ['TEUSDAY', 'TUESDAY'], ['TEUSDAY', 'THURSDAY'], ['TUESDAY', 'SOMETHING']].each do |a|
      @rblogic.leven *a
    end
  end

  # damlev

  tach('c-logic random damlev') do
    $clogic.damlev(rand_word, rand_word)
  end
  tach('rb-logic random damlev') do
    $rblogic.damlev(rand_word, rand_word)
  end

  tach('c-logic damlev') do
    [['CA', 'ABC'], ['TEUSDAY', 'TUESDAY'], ['TEUSDAY', 'THURSDAY'], ['TUESDAY', 'SOMETHING']].each do |a|
      @clogic.damlev *a
    end
  end

  tach('rb-logic damlev') do
    [['CA', 'ABC'], ['TEUSDAY', 'TUESDAY'], ['TEUSDAY', 'THURSDAY'], ['TUESDAY', 'SOMETHING']].each do |a|
      @rblogic.damlev *a
    end
  end

end

